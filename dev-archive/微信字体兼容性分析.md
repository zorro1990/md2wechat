# 微信公众号字体兼容性分析与修复方案

## 🔍 问题描述

用户反馈:**产品内渲染的字体,复制到微信后字体变了,没有显示效果**

---

## 📊 微信公众号字体支持情况

### ✅ **微信支持的字体**

根据调研,微信公众号**只支持系统默认字体**,不支持自定义字体或Web字体:

#### **iOS系统字体**:
- `PingFang SC` (苹方-简体中文) - iOS 9+
- `Hiragino Sans GB` (冬青黑体-简体中文) - iOS 8及以下
- `Helvetica Neue` (英文)
- `-apple-system` (系统默认)

#### **Android系统字体**:
- `Microsoft YaHei` (微软雅黑) - 部分Android
- `Noto Sans CJK SC` (思源黑体)
- `Roboto` (英文)

#### **Windows系统字体**:
- `Microsoft YaHei` (微软雅黑)
- `SimSun` (宋体)
- `SimHei` (黑体)

#### **通用Fallback字体**:
- `sans-serif` (无衬线字体族)
- `serif` (衬线字体族)
- `monospace` (等宽字体族)

### ❌ **微信不支持的字体**

- ❌ 任何自定义Web字体 (`@font-face`)
- ❌ 外部字体文件 (`.woff`, `.ttf`, `.otf`)
- ❌ 特殊字体如 `Georgia`, `Times New Roman` (在移动端不可靠)
- ❌ 中文特殊字体如 `STKaiti` (楷体), `KaiTi`, `Songti SC` (宋体) - 仅部分设备支持

---

## 🐛 当前项目存在的问题

### **问题字体列表**

通过扫描`presets.ts`,发现以下主题使用了微信不完全支持的字体:

1. **文艺复兴主题** (renaissance) - 第1079行
   ```typescript
   fontFamily: '"Georgia", "Times New Roman", "KaiTi", "STKaiti", serif'
   ```
   - ❌ `Georgia` - 移动端不可靠
   - ❌ `Times New Roman` - 移动端不可靠
   - ❌ `KaiTi`, `STKaiti` - 仅部分设备支持

2. **杂志风主题** (magazine) - 第2510行
   ```typescript
   fontFamily: '"Georgia", "Times New Roman", "Songti SC", serif, -apple-system, sans-serif'
   ```
   - ❌ `Georgia` - 移动端不可靠
   - ❌ `Times New Roman` - 移动端不可靠
   - ❌ `Songti SC` - 仅部分设备支持

3. **国潮风主题** (guochao) - 第2923行
   ```typescript
   fontFamily: '"STKaiti", "KaiTi", "Songti SC", "SimSun", serif, -apple-system, sans-serif'
   ```
   - ❌ `STKaiti`, `KaiTi` - 仅部分设备支持
   - ❌ `Songti SC`, `SimSun` - 仅部分设备支持

4. **赛博朋克风主题** (cyberpunk) - 第1522, 1658行
   ```typescript
   fontFamily: '"SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, "PingFang SC", "Microsoft YaHei", sans-serif'
   fontFamily: 'monospace'
   ```
   - ⚠️ `SFMono-Regular` - 仅macOS/iOS
   - ⚠️ `Liberation Mono` - 仅Linux

---

## ✅ 推荐的微信兼容字体方案

### **方案1: 通用无衬线字体** (适用于大部分主题)
```typescript
fontFamily: '-apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif'
```
**特点**: 现代、清晰、跨平台兼容性最好

### **方案2: 衬线字体** (适用于文艺、杂志风格)
```typescript
fontFamily: '"Songti SC", "SimSun", "STSong", serif, -apple-system, sans-serif'
```
**特点**: 优雅、传统,但需要fallback到无衬线

### **方案3: 等宽字体** (适用于代码块)
```typescript
fontFamily: '"Courier New", Courier, "PingFang SC", "Microsoft YaHei", monospace'
```
**特点**: 代码显示,跨平台兼容

### **方案4: 国风字体** (适用于国潮风)
```typescript
fontFamily: '"PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "STKaiti", "KaiTi", sans-serif'
```
**特点**: 优先使用可靠字体,楷体作为fallback

---

## 🎨 各主题字体匹配建议

| 主题 | 当前字体 | 问题 | 推荐字体 | 理由 |
|------|---------|------|---------|------|
| **中国风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **字节风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **孟菲斯** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **文艺复兴** | Georgia/Times | ❌ 不兼容 | 方案2 (衬线) | 保持优雅感 |
| **现代简约** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **赛博朋克风** | SFMono | ⚠️ 部分不兼容 | 方案3 (等宽) | 科技感 |
| **简约商务风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **清新文艺风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **卡片风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **杂志风** | Georgia/Times | ❌ 不兼容 | 方案2 (衬线) | 专业感 |
| **科技蓝风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **国潮风** | STKaiti/KaiTi | ❌ 不兼容 | 方案4 (国风) | 传统感 |
| **暖色调活力风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **极简黑白风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **小清新绿植风** | 无衬线 | ✅ 无问题 | 保持不变 | 已使用兼容字体 |
| **高端奢华风** | Georgia | ❌ 不兼容 | 方案2 (衬线) | 高级感 |

---

## 📝 修复计划

需要修复的主题:
1. ✅ **文艺复兴** (renaissance)
2. ✅ **杂志风** (magazine)
3. ✅ **国潮风** (guochao)
4. ✅ **高端奢华风** (luxury)
5. ⚠️ **赛博朋克风** (cyberpunk) - 优化等宽字体

---

## 💯 修复原则

1. **优先使用系统字体**: 确保跨平台兼容
2. **提供完整fallback链**: 从特定到通用
3. **保持风格一致性**: 字体选择符合主题定位
4. **测试验证**: 修复后在微信中测试

---

**下一步**: 执行字体修复

