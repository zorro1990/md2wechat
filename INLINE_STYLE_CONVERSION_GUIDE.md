# 🎯 内联样式转换功能使用指南

## 📋 概述

内联样式转换功能是 md2wechat 的核心特性之一，它能够将带有 CSS 类名的 HTML 转换为带有内联样式的 HTML，确保内容在微信公众号后台粘贴时能够保持原有的视觉样式。

**功能位置**：右上角工具栏的 "Copy" 按钮

---

## 🔧 技术原理

### 转换流程

1. **获取预览 HTML** - 从当前草稿的预览中获取渲染后的 HTML
2. **应用主题类** - 将主题相关的 CSS 类应用到临时元素
3. **解析 DOM** - 使用 DOMParser 解析 HTML 字符串
4. **计算样式** - 通过 getComputedStyle 获取计算后的样式值
5. **转换内联样式** - 将 CSS 类名转换为对应的内联 style 属性
6. **清理标记** - 移除 class、id 等属性，只保留语义标签
7. **复制到剪贴板** - 同时复制 HTML 和纯文本两种格式

### 支持的样式属性

- ✅ 字体相关：`font-family`, `font-size`, `font-weight`
- ✅ 颜色相关：`color`, `background-color`
- ✅ 文本样式：`text-align`, `text-decoration`
- ✅ 间距相关：`margin`, `padding`, `line-height`
- ✅ 边框相关：`border`, `border-radius`
- ✅ 阴影效果：`box-shadow`
- ✅ 列表样式：`list-style-type`
- ✅ 表格样式：`border-collapse`, `table-layout`
- ✅ 背景效果：`background`, `background-image`
- ✅ 变换效果：`transform`, `rotation`

### 主题变量转换

转换器会自动解析以下主题 CSS 变量：

```css
--wx-surface       /* 主题背景色 */
--wx-text          /* 主要文本色 */
--wx-heading       /* 标题文字色 */
--wx-subheading    /* 副标题色 */
--wx-accent        /* 强调色 */
--wx-link          /* 链接色 */
--wx-quote-border  /* 引用块边框色 */
--wx-code-bg       /* 代码块背景色 */
--wx-code-text     /* 代码块文字色 */
```

---

## 📖 使用方法

### 步骤 1：创建或选择草稿

在编辑器中输入 Markdown 内容，或从已有草稿中选择一个。

### 步骤 2：选择主题风格

点击右上角的 "Settings" 按钮，在主题风格区域选择合适的主题：

- 🏮 **中国风** - 传统、古典、雅致
- 🚀 **字节风** - 现代、简约、科技
- 🎨 **孟菲斯** - 几何、创意、活力
- 🏛️ **文艺复兴** - 经典、优雅、奢华
- ✨ **现代简约** - 清晰、简约、舒适
- 🌆 **赛博朋克风** - 未来、霓虹、科技

### 步骤 3：预览内容

在右侧预览窗格中查看渲染效果，确保样式符合预期。

### 步骤 4：执行转换复制

点击右上角工具栏的 "Copy" 按钮。

### 步骤 5：粘贴到微信公众号

1. 打开微信公众号后台编辑器
2. 在内容编辑区域粘贴（Ctrl/Cmd + V）
3. 样式将自动保持，无需额外调整

---

## ✅ 成功标志

当转换成功时，您将看到如下提示：

```
✅ 转换并复制成功
已复制带内联样式的HTML，可直接粘贴到微信公众号后台
```

---

## ⚠️ 注意事项

### 1. 浏览器兼容性

- ✅ Chrome/Edge 88+
- ✅ Firefox 85+
- ✅ Safari 14.1+
- ⚠️ 旧版浏览器可能不支持 Clipboard API，将自动降级使用 execCommand

### 2. 内容限制

- ✅ 支持标准 Markdown 语法
- ✅ 支持标题（H1-H6）
- ✅ 支持段落、列表、引用
- ✅ 支持代码块和行内代码
- ✅ 支持链接和图片
- ✅ 支持表格
- ❌ 不支持复杂的自定义 HTML（会被清理）

### 3. 样式保留

- ✅ 基本字体样式（大小、粗细、颜色）
- ✅ 布局样式（间距、边距）
- ✅ 简单装饰效果（边框、阴影）
- ⚠️ 复杂动画效果可能无法完全保留
- ⚠️ 某些伪元素效果可能被简化

### 4. 微信兼容性

- ✅ 内联样式完全兼容微信编辑器
- ✅ 颜色和字体在微信中正确显示
- ✅ 布局在移动端和 PC 端都能正常显示
- ⚠️ 某些高级效果（如 Glitch 动画）可能会丢失

---

## 🔍 故障排除

### 问题 1：复制失败

**症状**：点击 Copy 按钮后提示 "复制失败"

**解决方案**：
1. 检查浏览器是否允许剪贴板访问权限
2. 尝试刷新页面后重新复制
3. 确认当前草稿有预览内容

### 问题 2：粘贴后样式丢失

**症状**：在微信公众号后台粘贴后，样式与预期不符

**解决方案**：
1. 确认复制的是转换后的内容（带内联样式）
2. 检查是否选择了正确的主题
3. 尝试重新复制（可能第一次转换时出现异常）

### 问题 3：部分样式未应用

**症状**：某些元素样式与预览不符

**解决方案**：
1. 这是正常现象，因为微信编辑器的限制
2. 检查预览窗格，确保基础样式正确
3. 可以手动调整微信公众号后台的样式

---

## 📊 性能优化建议

### 1. 内容长度

- **推荐**：单个文档不超过 50,000 字符
- **原因**：转换时间随内容长度线性增长

### 2. 主题选择

- **简单内容**：推荐使用 "现代简约" 主题
- **复杂内容**：可使用任何主题，但转换时间略长

### 3. 媒体元素

- **图片**：建议提前上传到微信素材库
- **表格**：复杂表格建议截图或简化结构

---

## 🚀 高级用法

### 1. 批量复制

如需复制多个文档，建议：
1. 逐个转换和复制
2. 在微信后台使用"粘贴"而非"导入"功能
3. 及时保存为草稿，避免内容丢失

### 2. 主题测试

在正式发布前，可以：
1. 创建测试草稿
2. 尝试不同主题
3. 选择视觉效果最佳的主题

### 3. 样式微调

如果对某些细节不满意：
1. 转换后手动调整微信公众号后台的样式
2. 记住调整内容，以便下次使用

---

## 📈 版本历史

### v1.0.0 (2025-11-03)

- ✅ 初始版本发布
- ✅ 支持 6 种主题风格
- ✅ 支持所有基本 Markdown 元素
- ✅ 支持内联样式转换
- ✅ 支持剪贴板复制（HTML + 纯文本）
- ✅ 支持浏览器兼容性检测

---

## 🤝 贡献与反馈

如果您在使用过程中遇到问题或有改进建议，欢迎通过以下方式反馈：

1. 创建 Issue 描述问题
2. 提供复现步骤和预期行为
3. 附上截图或视频（如可能）

---

## 📝 结语

内联样式转换功能是 md2wechat 的核心价值，它解决了微信公众号编辑器样式丢失的痛点。通过本指南，您应该能够充分利用这一功能，创作出视觉效果出色的文章。

祝您使用愉快！🎉

---

*文档更新时间：2025-11-03*
*适用版本：md2wechat v1.0.0*
